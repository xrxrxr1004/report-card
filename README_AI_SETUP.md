# AI 코멘트 교정 기능 설정 가이드

## 개요
Google Gemini AI를 사용하여 학생 성적표 코멘트를 자연스럽고 종합적으로 다듬는 기능입니다.

## 보안 설정

### 1. API 키 발급
1. [Google AI Studio](https://makersuite.google.com/app/apikey)에 접속
2. Google 계정으로 로그인
3. "Create API Key" 버튼 클릭
4. API 키 복사

### 2. 환경 변수 설정
프로젝트 루트 디렉토리(`extracted/`)에 `.env.local` 파일을 생성하고 다음 내용을 추가하세요:

```env
GEMINI_API_KEY=여기에_발급받은_API_키_입력
```

**중요 보안 사항:**
- ✅ `.env.local` 파일은 `.gitignore`에 포함되어 있어 Git에 커밋되지 않습니다
- ✅ API 키는 서버 사이드에서만 사용됩니다 (클라이언트에 노출되지 않음)
- ✅ `.env.local` 파일을 절대 공유하거나 Git에 커밋하지 마세요

## 사용 방법

### 개별 코멘트 교정
1. 학생을 선택합니다
2. 상단 메뉴의 "AI 코멘트 교정" 버튼을 클릭합니다
3. AI가 코멘트를 다듬는 동안 잠시 기다립니다
4. 교정된 코멘트가 자동으로 반영됩니다

### 전체 코멘트 일괄 교정
1. 상단 메뉴의 "전체 AI 코멘트 교정" 버튼을 클릭합니다
2. 모든 학생의 코멘트가 순차적으로 교정됩니다
3. 진행 상황이 표시됩니다 (예: 교정 중... 5/20)
4. 완료되면 알림이 표시됩니다

## 기술적 세부사항

### 보안 구조
- **API 라우트**: `/app/api/comments/refine/route.ts`
  - 서버 사이드에서만 실행
  - API 키는 환경 변수에서만 읽어옴
  - 클라이언트에 API 키가 노출되지 않음

### API 호출 흐름
```
프론트엔드 (클라이언트)
  ↓ HTTP POST 요청 (API 키 없음)
API 라우트 (서버)
  ↓ 환경 변수에서 API 키 읽기
Google Gemini API
  ↓ AI 응답
API 라우트 (서버)
  ↓ 다듬어진 코멘트 반환
프론트엔드 (클라이언트)
  ↓ UI 업데이트
```

### Rate Limit 고려사항
- 일괄 교정 시 학생 간 1.5초 딜레이 적용
- API 호출 제한을 피하기 위한 조치

## 문제 해결

### "API 키 설정에 문제가 있습니다" 오류
- `.env.local` 파일이 프로젝트 루트에 있는지 확인
- API 키가 올바르게 입력되었는지 확인
- 개발 서버를 재시작 (`npm run dev`)

### "코멘트 교정에 실패했습니다" 오류
- 인터넷 연결 확인
- Gemini API 서비스 상태 확인
- API 키의 사용량 제한 확인

## 비용 안내
- Google Gemini API는 무료 티어를 제공합니다
- 사용량에 따라 비용이 발생할 수 있으니 [가격 정책](https://ai.google.dev/pricing)을 확인하세요

