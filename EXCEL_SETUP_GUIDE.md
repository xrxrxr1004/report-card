# Excel 설정 시트 사용 가이드

## 개요

각 주차별 Excel 파일에 "설정" 시트를 추가하여, 주차별로 다른 만점과 평가 항목을 설정할 수 있습니다.

## 1. 파일 구조

데이터 폴더(`data/`)에 다음과 같은 구조로 파일이 위치해야 합니다.

```
data/
├── students.xlsx       # [신규] 전체 학생 명부 (필수)
└── scores/            # 주차별 성적 파일 폴더
    ├── 2025-12-W1.xlsx
    ├── 2025-12-W2.xlsx
    └── ...
```

---

## 2. 학생 명부 설정 (`students.xlsx`)

전체 학생 목록을 관리하는 마스터 파일입니다. 이 파일에 있는 이름이 기준이 됩니다.

**필수 시트명**: `학생명부` (또는 첫 번째 시트)

| 이름 | 학교 | 반 | 연락처 |
| :--- | :--- | :--- | :--- |
| 홍길동 | 한국고 | S | 010-1234-5678 |
| 김철수 | 서울고 | H | 010-1111-2222 |

- **이름**: 학생 식별의 기준이 되므로 정확히 입력해야 합니다. (동명이인 주의)
- **반**: 성적 산출 시 반별 가중치 적용에 사용됩니다.

---

## 3. 주차별 성적 파일 설정 (`scores/*.xlsx`)

"설정" 시트는 다음과 같은 구조로 작성합니다:

| 항목 | 값 |
|------|-----|
| 독해단어1_만점 | 50 |
| 독해단어2_만점 | 40 |
| 문법이론_만점 | 100 |
| 문법응용_만점 | 46 |
| 모의고사_만점 | 100 |
| 독해단어1_이름 | 독해단어 1 |
| 독해단어2_이름 | 독해단어 2 |
| 문법이론_항목 | 시제,가정법,분사구문,준동사 |
| 모의고사_비율 | 0.40 |
| 문법응용_비율 | 0.30 |
| 문법이론_비율 | 0.20 |
| 독해단어_비율 | 0.10 |
| S반_가중치 | 1.3 |
| S'반_가중치 | 1.3 |
| H반_가중치 | 1.0 |
| G반_가중치 | 1.0 |
| 독해단어1_가중치적용 | false |
| 독해단어2_가중치적용 | true |
| 문법응용_가중치적용 | true |
| 문법이론_가중치적용 | false |
| 모의고사_가중치적용 | false |

## 설정 항목 설명

### 만점 설정

- **독해단어1_만점**: 독해단어 1번 항목의 만점 (기본값: 50)
- **독해단어2_만점**: 독해단어 2번 항목의 만점 (기본값: 40)
- **문법이론_만점**: 문법이론 만점 (기본값: 100)
- **문법응용_만점**: 문법응용 만점 (기본값: 46)
- **모의고사_만점**: 모의고사 만점 (기본값: 100)

### 항목명 및 부제 설정

- **독해단어1_이름**: 독해단어 1번 항목의 표시 이름 (기본값: "독해단어 1")
  - 예: "2주차 독해단어", "독해단어 1", "어휘 평가 1"
- **독해단어2_이름**: 독해단어 2번 항목의 표시 이름 (기본값: "독해단어 2")
- **문법응용_부제**: 문법응용 섹션의 부제 (기본값: "문법이론 응용 문제에 대한 평가입니다.")
- **모의고사_이름**: 모의고사 섹션의 메인 제목 (기본값: "모의고사 (Mock Exam)")
- **모의고사_부제**: 모의고사 섹션의 부제 (기본값: "고3 모의고사")

### 문법이론 주제 설정

- **문법이론_항목**: 문법이론 평가 주제 목록 (쉼표로 구분)
  - 예: "시제,가정법,분사구문,준동사"
  - 기본값: "시제,가정법,분사구문,준동사"

### 영역별 비율 설정 (선택사항)

전체 100점 만점으로 환산할 때 각 영역이 차지하는 비율을 설정합니다. (합계 1.0)

- **모의고사_비율**: 모의고사 비율 (기본값: 0.40 = 40%)
- **문법응용_비율**: 문법응용 비율 (기본값: 0.30 = 30%)
- **문법이론_비율**: 문법이론 비율 (기본값: 0.20 = 20%)
- **독해단어_비율**: 독해단어 비율 (기본값: 0.10 = 10%)

**주의**: 비율의 합은 반드시 **1.0 (100%)**이 되어야 합니다.
예: 모의고사(50%) + 독해단어(50%) = 1.0

**사용 예시**:
```
모의고사_비율: 0.5
독해단어_비율: 0.5
문법응용_비율: 0
문법이론_비율: 0
```

### 반별 가중치 설정

- **S반_가중치**: S반 가중치 (기본값: 1.3)
- **S'반_가중치**: S'반 가중치 (기본값: 1.3)
- **H반_가중치**: H반 가중치 (기본값: 1.0)
- **G반_가중치**: G반 가중치 (기본값: 1.0)

**사용 예시**: 
- S반 학생의 독해단어2 점수가 40점이면, 가중치 적용 시 40 × 1.3 = 52점으로 계산됩니다.
- 다른 반의 학생은 가중치가 적용되지 않거나 1.0으로 적용됩니다.

**추가 반 설정**: 새로운 반이 생기면 해당 반의 가중치를 추가할 수 있습니다.
- 예: `A반_가중치: 1.2`

### 항목별 가중치 적용 여부 설정

각 평가 항목에 반별 가중치를 적용할지 여부를 설정합니다.

- **독해단어1_가중치적용**: 독해단어1에 반별 가중치 적용 여부 (기본값: false)
- **독해단어2_가중치적용**: 독해단어2에 반별 가중치 적용 여부 (기본값: true)
- **문법응용_가중치적용**: 문법응용에 반별 가중치 적용 여부 (기본값: true)
- **문법이론_가중치적용**: 문법이론에 반별 가중치 적용 여부 (기본값: false)
- **모의고사_가중치적용**: 모의고사에 반별 가중치 적용 여부 (기본값: false)

**값 형식**: `true` 또는 `false` (대소문자 구분 없음)

**사용 예시**:
- 독해단어2_가중치적용이 `true`이면, S반 학생의 독해단어2 점수에 1.3배 가중치가 적용됩니다.
- 독해단어1_가중치적용이 `false`이면, 모든 반의 독해단어1 점수에 가중치가 적용되지 않습니다.

**항목이 추가/제거되는 경우**:
- 독해단어3 항목이 추가되면 `독해단어3_가중치적용` 항목을 설정 시트에 추가하면 됩니다.
- 항목이 제거되면 해당 항목의 가중치적용 설정도 제거하면 됩니다.

## 사용 예시

### 예시 1: 2주차 설정

| 항목 | 값 |
|------|-----|
| 독해단어1_만점 | 50 |
| 독해단어2_만점 | 40 |
| 독해단어1_이름 | 2주차 독해단어 |
| 독해단어2_이름 | 독해단어 2 |
| 문법이론_항목 | 시제,가정법 |
| S반_가중치 | 1.3 |
| 독해단어2_가중치적용 | true |

### 예시 2: 3주차 설정 (다른 항목)

| 항목 | 값 |
|------|-----|
| 독해단어1_만점 | 60 |
| 독해단어2_만점 | 50 |
| 독해단어1_이름 | 3주차 독해단어 |
| 독해단어2_이름 | 어휘 평가 2 |
| 문법이론_항목 | 분사구문,준동사,수동태 |
| S반_가중치 | 1.5 |
| 독해단어1_가중치적용 | true |
| 독해단어2_가중치적용 | true |

### 예시 3: 성적표 제목 및 부제 변경

| 항목 | 값 |
|------|-----|
| 모의고사_이름 | 3월 전국연합학력평가 |
| 모의고사_부제 | 고3 영어영역 |
| 문법응용_부제 | 수능특강 12강 응용 |
| 독해단어1_이름 | 수능특강 단어 1 |

## 주의사항

1. **설정 시트가 없는 경우**: 기본값이 사용됩니다.
2. **항목명에 쉼표 사용 금지**: 문법이론_항목을 제외하고는 쉼표를 사용하지 마세요.
3. **비율 합계**: 영역별 비율의 합은 1.0 (100%)이어야 합니다.
4. **시트 이름**: 시트 이름은 "설정", "config", "setting" 중 하나여야 합니다 (대소문자 구분 없음).
5. **가중치 값**: 반별 가중치는 숫자로 입력합니다 (예: 1.3, 1.0, 1.5).
6. **가중치 적용 여부**: `true` 또는 `false`로 입력합니다 (대소문자 구분 없음).

## Excel 파일 생성 방법

1. Excel 파일 열기
2. 시트 추가 (하단의 "+" 버튼)
3. 시트 이름을 "설정"으로 변경
4. A1 셀에 "항목", B1 셀에 "값" 입력
5. A2부터 설정 항목과 값을 입력
6. 저장

**또는 웹 UI에서 "Excel 템플릿 생성" 버튼을 클릭하여 설정 시트가 포함된 파일을 다운로드할 수 있습니다.**

## 평가 항목 동적 처리

### 현재 지원되는 동적 항목

1. **문법이론 주제**: `문법이론_항목`에서 쉼표로 구분하여 여러 주제를 설정할 수 있습니다.
   - 예: `시제,가정법` (2개 주제)
   - 예: `분사구문,준동사,수동태` (3개 주제)
   - 웹에서는 설정한 주제 수만큼 자동으로 표시됩니다.

2. **독해단어 항목**: 현재는 2개 항목(vocab1, vocab2)으로 기본 설정되어 있습니다.
   - `독해단어1_이름`, `독해단어2_이름`으로 항목명만 변경 가능
   - 항목 수를 늘리거나 줄이려면 Excel 파일의 성적 시트에서 해당 컬럼을 추가/제거하면 됩니다.
   - 예: 독해단어 항목이 1개만 있는 경우, `독해단어2` 컬럼을 제거하면 웹에서도 1개만 표시됩니다.

### 평가 항목 변경 방법

**항목 수 변경:**
- Excel 파일의 "성적" 시트에서 컬럼을 추가하거나 제거
- 예: 독해단어를 3개로 늘리려면 `독해단어3` 컬럼 추가
- 설정 시트에 `독해단어3_만점`, `독해단어3_이름`, `독해단어3_가중치적용` 추가

**항목명 변경:**
- 설정 시트에서 `독해단어1_이름`, `독해단어2_이름` 등으로 변경
- 웹에서 자동으로 반영됩니다.

**문법이론 주제 변경:**
- 설정 시트의 `문법이론_항목`에서 쉼표로 구분하여 변경
- 주제 수가 줄어들거나 늘어나면 웹에서도 자동으로 반영됩니다.

**반별 가중치 변경:**
- 설정 시트에서 `S반_가중치`, `H반_가중치` 등을 변경
- 새로운 반이 생기면 해당 반의 가중치를 추가

**항목별 가중치 적용 여부 변경:**
- 설정 시트에서 `독해단어1_가중치적용`, `문법응용_가중치적용` 등을 변경
- 항목이 추가되면 해당 항목의 가중치적용 설정도 추가

## 확인 방법

설정이 제대로 적용되었는지 확인하려면:
1. 웹 애플리케이션에서 해당 주차 선택
2. 성적표에서 항목명과 만점이 설정한 값으로 표시되는지 확인
3. 평가 항목 수가 변경된 경우, 웹에서도 올바르게 표시되는지 확인
4. 반별 가중치가 올바르게 적용되는지 확인 (S반 학생의 점수 확인)
