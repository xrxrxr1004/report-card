const { google } = require('googleapis');
require('dotenv').config({ path: '.env.local' });

const SPREADSHEET_ID = '19BkUNdxQ8NksgrYsbLzID-Rv6B14R8TRdQ26E6uNhig';
const GOOGLE_SERVICE_ACCOUNT_EMAIL = process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL;
const GOOGLE_PRIVATE_KEY = process.env.GOOGLE_PRIVATE_KEY ? process.env.GOOGLE_PRIVATE_KEY.replace(/\\n/g, "\n") : null;

// 둔산여고 개인별 총평 데이터 (엑셀에서 추출)
const COMMENTS = {
  '이연수': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '김예지': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '김민규': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '정유진': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '서현진': '세부사항 독해력을 바탕으로 성장 가능성이 있습니다. 문법 개념 정리와 함께 2-F 분석 훈련을 병행하면 중심내용 파악 능력도 향상될 것입니다. 어휘 암기와 복습 루틴을 확립하는 것이 중요합니다.',
  '정하율': '세부사항 독해력은 양호하나, 중심내용 파악에서 어려움을 겪고 있습니다. 2-F 분석법과 키워드 연결 훈련으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘 암기를 꾸준히 하면서 복습 루틴을 확립하세요.',
  '피민준': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '최성민': '세부사항 독해는 괜찮으나, 문법 영역에서 보완이 필요합니다. 문법은 핵심 개념을 암기하고 여러 문법을 동시에 적용하는 복합 문제 연습이 필요합니다. 이 훈련이 되면 중심내용 파악 능력도 자연스럽게 향상됩니다. 어휘는 꾸준한 암기가 필수입니다.',
  '박지호': '세부사항 독해력은 양호하나, 중심내용 파악에서 어려움을 겪고 있습니다. 2-F 분석법과 키워드 연결 훈련으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘 암기를 꾸준히 하면서 복습 루틴을 확립하세요.',
  '김민건': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '박채원': '중심내용 파악 능력이 뛰어나며, 글의 핵심을 잡아내는 응용력이 강점입니다. 둔산여고 내신은 Paraphrase 변형이 많으므로 세부사항 독해에서 문법적 독해 훈련을 병행하면 더욱 안정적인 고득점을 기대할 수 있습니다. 어휘는 꾸준히 유지하세요.',
  '이은서': '세부사항 독해력을 바탕으로 성장 가능성이 있습니다. 문법 개념 정리와 함께 2-F 분석 훈련을 병행하면 중심내용 파악 능력도 향상될 것입니다. 어휘 암기와 복습 루틴을 확립하는 것이 중요합니다.',
  '이시준': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '김시율': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '강채원': '문법 개념 이해가 우선 과제입니다. 핵심 개념을 암기하고 여러 문법이 동시에 적용되는 연습을 해야 합니다. 이후 문법적 독해와 Paraphrase 훈련으로 이어가면 전반적인 실력 향상을 기대할 수 있습니다. 어휘는 매일 꾸준히 암기하세요.',
  '김승찬': '세부사항 독해력은 양호하나, 중심내용 파악에서 어려움을 겪고 있습니다. 2-F 분석법과 키워드 연결 훈련으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘 암기를 꾸준히 하면서 복습 루틴을 확립하세요.',
  '김채원': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '오은서': '여러 영역에서 고르게 보완이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 우선 과제입니다.',
  '정영상': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '박서정': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '이윤서': '여러 영역에서 고르게 보완이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 우선 과제입니다.',
  '이도현': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '박지민': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '문영준': '문법 개념 이해가 우선 과제입니다. 핵심 개념을 암기하고 여러 문법이 동시에 적용되는 연습을 해야 합니다. 이후 문법적 독해와 Paraphrase 훈련으로 이어가면 전반적인 실력 향상을 기대할 수 있습니다. 어휘는 매일 꾸준히 암기하세요.',
  '김수아': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '김현아': '전 영역에서 고른 실력을 보여주고 있으며, 특히 어휘력과 문법 이해도가 뛰어납니다. 둔산여고는 변형 문제와 고난도 빈칸추론이 많이 출제되므로, 현재 실력을 유지하면서 2-F 분석과 키워드 훈련을 통해 실수를 줄이면 최상위권을 안정적으로 유지할 수 있습니다.',
  '김소율': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '박민준': '독해 영역에서 강점을 보이며, 지문 이해력이 우수합니다. 다만 어휘와 어법에서 보완이 필요합니다. 어휘는 매일 꾸준히 암기하고, 문법은 여러 개념이 동시에 적용되는 복합 문제 연습을 통해 응용력을 키우면 상위권 진입이 가능합니다.',
  '현민광': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '김라희': '독해 영역에서 강점을 보이며, 지문 이해력이 우수합니다. 다만 어휘와 어법에서 보완이 필요합니다. 어휘는 매일 꾸준히 암기하고, 문법은 여러 개념이 동시에 적용되는 복합 문제 연습을 통해 응용력을 키우면 상위권 진입이 가능합니다.',
  '정승원': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '길영찬': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '신예서': '중심내용 파악 능력이 뛰어나며, 글의 핵심을 잡아내는 응용력이 강점입니다. 둔산여고 내신은 Paraphrase 변형이 많으므로 세부사항 독해에서 문법적 독해 훈련을 병행하면 더욱 안정적인 고득점을 기대할 수 있습니다. 어휘는 꾸준히 유지하세요.',
  '장윤영': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '정태연': '여러 영역에서 고르게 보완이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 우선 과제입니다.',
  '송인창': '문법 개념 이해가 우선 과제입니다. 핵심 개념을 암기하고 여러 문법이 동시에 적용되는 연습을 해야 합니다. 이후 문법적 독해와 Paraphrase 훈련으로 이어가면 전반적인 실력 향상을 기대할 수 있습니다. 어휘는 매일 꾸준히 암기하세요.',
  '양희선': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '이아윤': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '박지원': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '최지오': '문법 개념 이해가 우선 과제입니다. 핵심 개념을 암기하고 여러 문법이 동시에 적용되는 연습을 해야 합니다. 이후 문법적 독해와 Paraphrase 훈련으로 이어가면 전반적인 실력 향상을 기대할 수 있습니다. 어휘는 매일 꾸준히 암기하세요.',
  '지선우': '세부사항 독해력은 양호하나, 중심내용 파악에서 어려움을 겪고 있습니다. 2-F 분석법과 키워드 연결 훈련으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘 암기를 꾸준히 하면서 복습 루틴을 확립하세요.',
  '문소은': '세부사항 독해력을 바탕으로 성장 가능성이 있습니다. 문법 개념 정리와 함께 2-F 분석 훈련을 병행하면 중심내용 파악 능력도 향상될 것입니다. 어휘 암기와 복습 루틴을 확립하는 것이 중요합니다.',
  '최상훈': '여러 영역에서 고르게 보완이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 우선 과제입니다.',
  '김민찬': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '윤지우': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '조현서': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '안예주': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '이준원': '문법 개념에 대한 이해도가 좋으며, 이는 둔산여고 내신 서술형 대비에 큰 강점이 됩니다. 중심내용 파악은 2-F 분석과 키워드 훈련으로, 세부사항은 Paraphrase 훈련으로 보완하세요. 어휘력 향상을 위해 매일 단어 암기 루틴을 확립하면 상위권 도약이 충분히 가능합니다.',
  '김주원': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '서온유': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '최다은': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '원지윤': '세부사항 독해력이 양호하며, 지문의 내용을 정확히 파악하는 능력이 좋습니다. 다만 중심내용 파악에서 아쉬운 부분이 있으므로 2-F 분석법으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘는 매일 꾸준한 암기 루틴을 만들어야 합니다.',
  '이정윤': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '박시우': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '최현준': '독해 영역에서 강점을 보이며, 지문 이해력이 우수합니다. 다만 어휘와 어법에서 보완이 필요합니다. 어휘는 매일 꾸준히 암기하고, 문법은 여러 개념이 동시에 적용되는 복합 문제 연습을 통해 응용력을 키우면 상위권 진입이 가능합니다.',
  '이서율': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '방나현': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '김민제': '전반적인 기초 학습이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다. 기초가 잡히면 실력은 반드시 따라옵니다.',
  '성민준': '기본기를 다지는 단계입니다. 문법 개념 정리부터 시작하여 문법적 독해, Paraphrase 훈련, 2-F 분석 순으로 단계별 학습을 권장합니다. 어휘는 매일 꾸준한 암기가 필수이며, 복습 루틴을 확립하면 성적 향상이 가능합니다.',
  '김효인': '세부사항 독해는 괜찮으나, 문법 영역에서 보완이 필요합니다. 문법은 핵심 개념을 암기하고 여러 문법을 동시에 적용하는 복합 문제 연습이 필요합니다. 이 훈련이 되면 중심내용 파악 능력도 자연스럽게 향상됩니다. 어휘는 꾸준한 암기가 필수입니다.',
  '임준희': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
  '한채영': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '김하윤': '여러 영역에서 고르게 보완이 필요한 상태입니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순으로 단계별로 진행하는 것이 효과적입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 우선 과제입니다.',
  '이민혁': '세부사항 독해는 괜찮으나, 문법 영역에서 보완이 필요합니다. 문법은 핵심 개념을 암기하고 여러 문법을 동시에 적용하는 복합 문제 연습이 필요합니다. 이 훈련이 되면 중심내용 파악 능력도 자연스럽게 향상됩니다. 어휘는 꾸준한 암기가 필수입니다.',
  '주보근': '세부사항 독해력은 양호한 편이나, 어법과 중심내용 파악에서 보완이 필요합니다. 우선 문법 개념을 확실히 정리하고, 문법적 독해 능력을 키운 후 2-F 분석으로 이어가는 단계별 학습이 효과적입니다. 어휘는 매일 꾸준히 암기하세요.',
  '김나연': '세부사항 독해력은 양호하나, 중심내용 파악에서 어려움을 겪고 있습니다. 2-F 분석법과 키워드 연결 훈련으로 글의 핵심 흐름을 잡는 연습이 필요합니다. 어휘 암기를 꾸준히 하면서 복습 루틴을 확립하세요.',
  '박효주': '세부사항 독해력을 바탕으로 성장 가능성이 있습니다. 문법 개념 정리와 함께 2-F 분석 훈련을 병행하면 중심내용 파악 능력도 향상될 것입니다. 어휘 암기와 복습 루틴을 확립하는 것이 중요합니다.',
  '김용우': '세부사항 독해력은 어느 정도 있으므로, 이를 바탕으로 기초부터 체계적으로 쌓아가면 됩니다. 학습 순서는 문법 개념 이해 → 문법적 독해 → Paraphrase 훈련 → 2-F/키워드 훈련 순입니다. 어휘는 매일 꾸준히 암기해야 하며, 숙제 이행률을 높이고 복습 루틴을 확립하는 것이 최우선 과제입니다.',
};

async function main() {
  const auth = new google.auth.GoogleAuth({
    credentials: {
      client_email: GOOGLE_SERVICE_ACCOUNT_EMAIL,
      private_key: GOOGLE_PRIVATE_KEY,
    },
    scopes: ['https://www.googleapis.com/auth/spreadsheets'],
  });

  const sheets = google.sheets({ version: 'v4', auth });

  // 기존 데이터 읽기
  const response = await sheets.spreadsheets.values.get({
    spreadsheetId: SPREADSHEET_ID,
    range: '내신기출성적!A:O',
  });

  const rows = response.data.values;
  console.log('기존 행 수:', rows.length);

  // 헤더에 '총평' 컬럼 추가 (없으면)
  if (rows[0].length === 14) {
    rows[0].push('총평');
  }

  // 각 행에 총평 추가
  for (let i = 1; i < rows.length; i++) {
    const name = rows[i][0];
    const school = rows[i][2];

    if (school === '둔산여고' && COMMENTS[name]) {
      // 14번째 컬럼에 총평 추가
      if (rows[i].length === 14) {
        rows[i].push(COMMENTS[name]);
      } else {
        rows[i][14] = COMMENTS[name];
      }
    } else if (rows[i].length === 14) {
      rows[i].push(''); // 다른 학교는 빈 값
    }
  }

  // 시트 덮어쓰기
  await sheets.spreadsheets.values.clear({
    spreadsheetId: SPREADSHEET_ID,
    range: '내신기출성적!A:O',
  });

  await sheets.spreadsheets.values.update({
    spreadsheetId: SPREADSHEET_ID,
    range: '내신기출성적!A1',
    valueInputOption: 'RAW',
    requestBody: { values: rows }
  });

  console.log('✅ 개인별 총평 추가 완료!');
}

main().catch(console.error);
