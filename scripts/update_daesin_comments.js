require('dotenv').config({ path: '.env.local' });
const { google } = require('googleapis');

const SPREADSHEET_ID = process.env.GOOGLE_SPREADSHEET_ID;
const GOOGLE_SERVICE_ACCOUNT_EMAIL = process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL;
const GOOGLE_PRIVATE_KEY = process.env.GOOGLE_PRIVATE_KEY ? process.env.GOOGLE_PRIVATE_KEY.replace(/\\n/g, "\n") : null;

// 대신고 개인별 총평 데이터
const DAESIN_COMMENTS = {
  '길영찬': '대신고 시험은 함정 선지가 많아 실수를 유발하는 시험이 특징이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '이연수': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악에서 주제를 놓치는 경우가 있어서 세부 유형에서도 실수가 이어졌습니다. 글의 핵심 문장을 찾고 반복되는 단어에 주목하는 연습부터 시작하면 전체적으로 좋아질 수 있습니다.',
  '김소율': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 지문 이해 자체가 어려웠던 것으로 보입니다. 문법 기초를 다지면서 문장 구조를 정확히 해석하는 연습을 하면, 독해력도 함께 올라가면서 점차 나아질 수 있습니다.',
  '서현진': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '피민준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 문제에서 정답에 가까이 간 흔적이 있어 긍정적입니다. 문법 기초를 다지면서 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '김민건': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '이은서': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '최성민': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '조현서': '대신고 시험은 함정 선지가 많아 실수를 유발하는 시험이 특징이었습니다. 대의파악에서 주제를 놓치는 경우가 있어서 세부 유형에서도 실수가 이어졌습니다. 글의 핵심 문장을 찾고 반복되는 단어에 주목하는 연습부터 시작하면 전체적으로 좋아질 수 있습니다.',
  '박지호': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악 문제에서 주제를 놓친 경우가 있었습니다. 글의 첫 문장과 마지막 문장에서 핵심을 찾고, 반복되는 키워드에 주목하는 연습을 하면 도움이 됩니다.',
  '김시율': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어휘 문제에서 문맥 파악이 아쉬웠습니다. 단어의 사전적 의미보다 해당 문맥에서 어떤 의미인지 파악하는 연습을 하면 좋겠습니다.',
  '박채원': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '김승찬': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 기본적인 대의파악은 되지만 세부 유형에서 실수가 많았습니다. 글의 중심내용을 먼저 정확히 파악하고, 그 위에 세부 유형을 쌓아가는 연습을 하면 좋겠습니다.',
  '장윤영': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '강채원': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '최지오': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 좋으나, 유사오답에서 아쉽게 걸린 경우가 있었습니다. 최종 선택 전에 \'왜 이것이 정답인지\' 본문에서 근거를 다시 확인하는 연습을 하면 실수를 줄일 수 있습니다.',
  '박효주': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악은 잘 되지만 순서/삽입 유형에서 실수가 있었습니다. 문장 간 연결고리인 연결어와 지시어를 찾는 연습을 하면 이 유형에서 정확도가 올라갑니다.',
  '이도현': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 기본적인 대의파악은 되지만 세부 유형에서 실수가 많았습니다. 글의 중심내용을 먼저 정확히 파악하고, 그 위에 세부 유형을 쌓아가는 연습을 하면 좋겠습니다.',
  '문영준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '윤지우': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 지문 이해 자체가 어려웠던 것으로 보입니다. 문법 기초를 다지면서 문장 구조를 정확히 해석하는 연습을 하면, 독해력도 함께 올라가면서 점차 나아질 수 있습니다.',
  '김수아': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '신예서': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대부분의 문제에서 뛰어난 독해력을 보여주었고, 15번 순서 문제에서만 아쉬운 실수가 있었습니다. 순서 문제는 연결어와 지시어에 집중하면 함정을 피할 수 있습니다.',
  '이시준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '김현아': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 전반적으로 안정적인 실력을 보여주었으나 일부 함정에서 아쉬운 실수가 있었습니다. 선지를 고를 때 본문 근거를 꼼꼼히 확인하는 연습을 하면 더 좋아질 수 있습니다.',
  '송인창': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악은 잘 되지만 순서/삽입 유형에서 실수가 있었습니다. 문장 간 연결고리인 연결어와 지시어를 찾는 연습을 하면 이 유형에서 정확도가 올라갑니다.',
  '김민규': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '정영상': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '김라희': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '양희선': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '지선우': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악에서 주제를 놓치는 경우가 있어서 세부 유형에서도 실수가 이어졌습니다. 글의 핵심 문장을 찾고 반복되는 단어에 주목하는 연습부터 시작하면 전체적으로 좋아질 수 있습니다.',
  '문소은': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 있으나 유사오답에서 여러 번 아쉽게 걸렸습니다. 선지를 고를 때 본문에서 근거를 찾아 검증하는 습관을 들이면 점수가 크게 오를 수 있습니다.',
  '정태연': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '김민찬': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '안예주': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 글의 주제를 찾는 기본기가 필요합니다. 쉬운 지문부터 시작해서 핵심 문장 찾기를 매일 연습하면, 점차 다른 유형에서도 정확도가 올라갈 수 있습니다.',
  '최현준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '방나현': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악은 어느 정도 되니 그것을 발판으로 삼으면 좋겠습니다. 주제를 파악한 후 세부 유형으로 확장하는 연습을 하면 점차 좋아질 수 있습니다.',
  '박우정': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '원지윤': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 좋으나, 유사오답에서 아쉽게 걸린 경우가 있었습니다. 최종 선택 전에 \'왜 이것이 정답인지\' 본문에서 근거를 다시 확인하는 연습을 하면 실수를 줄일 수 있습니다.',
  '성민준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 기본적인 대의파악은 되지만 세부 유형에서 실수가 많았습니다. 글의 중심내용을 먼저 정확히 파악하고, 그 위에 세부 유형을 쌓아가는 연습을 하면 좋겠습니다.',
  '오은서': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '이아윤': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '이준원': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 함정 선지들을 대부분 잘 피해갔고, 11번 빈칸에서만 아쉬운 실수가 있었습니다. 빈칸은 글의 주제를 먼저 파악한 후 논리적 흐름을 따라가면 정확도가 더 올라갑니다.',
  '이정윤': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '현민광': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '김효인': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '김나연': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 기본적인 대의파악은 되지만 세부 유형에서 실수가 많았습니다. 글의 중심내용을 먼저 정확히 파악하고, 그 위에 세부 유형을 쌓아가는 연습을 하면 좋겠습니다.',
  '유희수': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '정승원': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 지문 이해 자체가 어려웠던 것으로 보입니다. 문법 기초를 다지면서 문장 구조를 정확히 해석하는 연습을 하면, 독해력도 함께 올라가면서 점차 나아질 수 있습니다.',
  '이서율': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '김예지': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 좋으나, 유사오답에서 아쉽게 걸린 경우가 있었습니다. 최종 선택 전에 \'왜 이것이 정답인지\' 본문에서 근거를 다시 확인하는 연습을 하면 실수를 줄일 수 있습니다.',
  '최다은': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '김민제': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악에서 주제를 놓치는 경우가 있어서 세부 유형에서도 실수가 이어졌습니다. 글의 핵심 문장을 찾고 반복되는 단어에 주목하는 연습부터 시작하면 전체적으로 좋아질 수 있습니다.',
  '강리호': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '임준희': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '서온유': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '이시은': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악은 잘 되지만 순서/삽입 유형에서 실수가 있었습니다. 문장 간 연결고리인 연결어와 지시어를 찾는 연습을 하면 이 유형에서 정확도가 올라갑니다.',
  '김용우': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '정하율': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 대의파악은 잘 되지만 순서/삽입 유형에서 실수가 있었습니다. 문장 간 연결고리인 연결어와 지시어를 찾는 연습을 하면 이 유형에서 정확도가 올라갑니다.',
  '김채원': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '박지민': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 정답 후보를 좁히는 능력은 좋으나, 유사오답에서 아쉽게 걸린 경우가 있었습니다. 최종 선택 전에 \'왜 이것이 정답인지\' 본문에서 근거를 다시 확인하는 연습을 하면 실수를 줄일 수 있습니다.',
  '최상훈': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 전반적으로 안정적인 실력을 보여주었으나 일부 함정에서 아쉬운 실수가 있었습니다. 선지를 고를 때 본문 근거를 꼼꼼히 확인하는 연습을 하면 더 좋아질 수 있습니다.',
  '이민혁': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 빈칸 문제에서 아쉬운 실수가 있었습니다. 빈칸은 글의 중심내용을 먼저 파악하고, 선지를 보기 전에 들어갈 내용을 예측해보는 연습을 하면 정확도가 올라갑니다.',
  '정유진': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 지문 이해 자체가 어려웠던 것으로 보입니다. 문법 기초를 다지면서 문장 구조를 정확히 해석하는 연습을 하면, 독해력도 함께 올라가면서 점차 나아질 수 있습니다.',
  '박서정': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 일부 유사오답을 골라 정답에 가까이 간 문제도 있었습니다. 본문에서 근거를 찾아 검증하는 습관을 들이고, 중심내용 파악 연습을 병행하면 점차 좋아질 수 있습니다.',
  '박민준': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 전반적으로 안정적인 실력을 보여주었으나 일부 함정에서 아쉬운 실수가 있었습니다. 선지를 고를 때 본문 근거를 꼼꼼히 확인하는 연습을 하면 더 좋아질 수 있습니다.',
  '한채영': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 어법과 독해 모두 보완이 필요한데, 문법 구조를 이해하면 독해 정확도도 함께 올라갑니다. 문장 구조를 파악하며 정확히 해석하는 연습을 하면 점차 나아질 수 있습니다.',
  '이하윤': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 기본적인 대의파악은 되지만 세부 유형에서 실수가 많았습니다. 글의 중심내용을 먼저 정확히 파악하고, 그 위에 세부 유형을 쌓아가는 연습을 하면 좋겠습니다.',
  '박시우': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 전반적으로 안정적인 실력을 보여주었으나 일부 함정에서 아쉬운 실수가 있었습니다. 선지를 고를 때 본문 근거를 꼼꼼히 확인하는 연습을 하면 더 좋아질 수 있습니다.',
  '이윤서': '대신고 시험은 함정 선지가 많아 정답에 가까운 오답을 구별하는 것이 핵심이었습니다. 시험에서 유사오답을 2개 골라 아쉽습니다. 정답 후보를 좁히는 능력은 있으나 최종 선택에서 본문 근거 확인이 부족했습니다. 선지를 고를 때 \'왜 이것이 정답인지\' 본문에서 근거를 찾는 습관을 들이면 점수가 크게 오를 수 있습니다.',
};

async function main() {
  if (!SPREADSHEET_ID || !GOOGLE_SERVICE_ACCOUNT_EMAIL || !GOOGLE_PRIVATE_KEY) {
    console.error('환경 변수가 설정되지 않았습니다.');
    return;
  }

  const auth = new google.auth.GoogleAuth({
    credentials: {
      client_email: GOOGLE_SERVICE_ACCOUNT_EMAIL,
      private_key: GOOGLE_PRIVATE_KEY,
    },
    scopes: ['https://www.googleapis.com/auth/spreadsheets'],
  });

  const sheets = google.sheets({ version: 'v4', auth });

  // 내신기출성적 시트 읽기
  const response = await sheets.spreadsheets.values.get({
    spreadsheetId: SPREADSHEET_ID,
    range: '내신기출성적',
  });

  const rows = response.data.values;
  if (!rows || rows.length === 0) {
    console.log('데이터가 없습니다.');
    return;
  }

  const headers = rows[0];
  console.log('헤더:', headers);

  // 컬럼 인덱스 찾기
  const nameIdx = headers.indexOf('이름');
  const schoolIdx = headers.indexOf('학교');
  let commentIdx = headers.indexOf('총평');

  console.log('컬럼 인덱스:', { nameIdx, schoolIdx, commentIdx });

  if (commentIdx === -1) {
    // 총평 컬럼이 없으면 추가
    console.log('총평 컬럼이 없어서 추가합니다...');
    commentIdx = headers.length;
    await sheets.spreadsheets.values.update({
      spreadsheetId: SPREADSHEET_ID,
      range: `내신기출성적!${String.fromCharCode(65 + commentIdx)}1`,
      valueInputOption: 'RAW',
      requestBody: {
        values: [['총평']]
      }
    });
    console.log('총평 컬럼 추가 완료 (열:', String.fromCharCode(65 + commentIdx) + ')');
  }

  console.log('총평 업데이트 시작...');
  console.log('총 행 수:', rows.length);

  // 각 행의 총평 업데이트
  const updates = [];
  let updateCount = 0;

  for (let i = 1; i < rows.length; i++) {
    const row = rows[i];
    const name = row[nameIdx];
    const school = row[schoolIdx];

    // 대신고 학생만 업데이트
    if (school === '대신고' && DAESIN_COMMENTS[name]) {
      updates.push({
        range: `내신기출성적!${String.fromCharCode(65 + commentIdx)}${i + 1}`,
        values: [[DAESIN_COMMENTS[name]]]
      });
      updateCount++;
      console.log(`  ${name} (${school}) - 총평 업데이트 예정`);
    }
  }

  if (updates.length > 0) {
    await sheets.spreadsheets.values.batchUpdate({
      spreadsheetId: SPREADSHEET_ID,
      requestBody: {
        valueInputOption: 'RAW',
        data: updates
      }
    });
    console.log(`\n✅ ${updateCount}명의 대신고 학생 총평 업데이트 완료!`);
  } else {
    console.log('업데이트할 대신고 학생이 없습니다.');
  }
}

main().catch(console.error);
